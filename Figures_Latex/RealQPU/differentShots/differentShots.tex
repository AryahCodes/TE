
\documentclass[margin=5pt]{standalone}
\usepackage{pgfplots}
\usetikzlibrary{pgfplots.groupplots}
\pgfplotsset{compat=newest}
\usepackage{subcaption}
\usetikzlibrary{plotmarks}
\usepackage{palatino}
\newlength{\mainwidth}
\setlength{\mainwidth}{460pt}
\definecolor{color1}{HTML}{1b9e77}
\definecolor{color2}{HTML}{d95f02}
\definecolor{color3}{HTML}{7570b3}
\definecolor{color4}{HTML}{e7298a}
\definecolor{color5}{HTML}{66a61e}
\definecolor{color6}{HTML}{e6ab02}
\definecolor{color7}{HTML}{a6761d}
\begin{document}
\begin{tikzpicture}
\begin{groupplot}[
 group style={
 group size=3 by 2,
 horizontal sep=0.05\mainwidth,
 vertical sep=0.1\mainwidth,
 },
 width=0.4\mainwidth,
 height=0.3\mainwidth,
 xlabel=$x$,
 grid=major,
]
\nextgroupplot[
 ylabel=$u(x)$,
 title={1 Shot},
]
\addplot[line width=1pt, opacity=0.4] table [x=x, y=u_state, col sep=space] {state_solution.dat};
\addplot[only marks, mark=diamond*, mark options={color=color1}] table [x=x, y=u_shots_1shot, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=triangle*, mark options={color=color2}] table [x=x, y=u_noise_shots_1shot, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=asterisk, mark options={color=color3}] table [x=x, y=u_real_1shot, col sep=space] {shots_solution.dat};

\nextgroupplot[
 title={10 Shots},
]
\addplot[line width=1pt, opacity=0.4] table [x=x, y=u_state, col sep=space] {state_solution.dat};
\addplot[only marks, mark=diamond*, mark options={color=color1}] table [x=x, y=u_shots_10shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=triangle*, mark options={color=color2}] table [x=x, y=u_noise_shots_10shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=asterisk, mark options={color=color3}] table [x=x, y=u_real_10shots, col sep=space] {shots_solution.dat};

\nextgroupplot[
 title={100 Shots},
]
\addplot[line width=1pt, opacity=0.4] table [x=x, y=u_state, col sep=space] {state_solution.dat};
\addplot[only marks, mark=diamond*, mark options={color=color1}] table [x=x, y=u_shots_100shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=triangle*, mark options={color=color2}] table [x=x, y=u_noise_shots_100shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=asterisk, mark options={color=color3}] table [x=x, y=u_real_100shots, col sep=space] {shots_solution.dat};

\nextgroupplot[
 ylabel=$u(x)$,
 title={1,000 Shots},
]
\addplot[line width=1pt, opacity=0.4] table [x=x, y=u_state, col sep=space] {state_solution.dat};
\addplot[only marks, mark=diamond*, mark options={color=color1}] table [x=x, y=u_shots_1000shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=triangle*, mark options={color=color2}] table [x=x, y=u_noise_shots_1000shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=asterisk, mark options={color=color3}] table [x=x, y=u_real_1000shots, col sep=space] {shots_solution.dat};

\nextgroupplot[
 title={10,000 Shots},
]
\addplot[line width=1pt, opacity=0.4] table [x=x, y=u_state, col sep=space] {state_solution.dat};
\addplot[only marks, mark=diamond*, mark options={color=color1}] table [x=x, y=u_shots_10000shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=triangle*, mark options={color=color2}] table [x=x, y=u_noise_shots_10000shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=asterisk, mark options={color=color3}] table [x=x, y=u_real_10000shots, col sep=space] {shots_solution.dat};

\nextgroupplot[
 title={100,000 Shots},
 legend style={
 at={($(0.5,-0.4)$)},
 anchor=north,
 legend columns=4,
 /tikz/every even column/.append style={column sep=0.5cm},
 },
 legend to name=named,
]
\addplot[line width=1pt, opacity=0.4] table [x=x, y=u_state, col sep=space] {state_solution.dat};
\addplot[only marks, mark=diamond*, mark options={color=color1}] table [x=x, y=u_shots_100000shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=triangle*, mark options={color=color2}] table [x=x, y=u_noise_shots_100000shots, col sep=space] {shots_solution.dat};
\addplot[only marks, mark=asterisk, mark options={color=color3}] table [x=x, y=u_real_100000shots, col sep=space] {shots_solution.dat};
\legend{Simulated State Vector, Simulated Ideal Shots,Simulated Noisy Shots, Real Device}
\end{groupplot}

\node[below] at ($(group c1r2.south)!0.5!(group c3r2.south)-(0,0.8cm)$) {\ref{named}};
\end{tikzpicture}
\end{document}